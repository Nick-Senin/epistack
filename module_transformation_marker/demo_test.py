"""
–î–µ–º–æ-—Ç–µ—Å—Ç –º–æ–¥—É–ª—è TransformationMarker
"""
import os
import sys

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –ø—É—Ç—å
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from module_transformation_marker.config import configure_module_llm
from module_transformation_marker.module import TransformationMarker


def main():
    """
    –î–µ–º–æ-—Ç–µ—Å—Ç –º–æ–¥—É–ª—è TransformationMarker
    """
    print("üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LLM...")
    configure_module_llm()
    
    print("\n" + "=" * 80)
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è TransformationMarker")
    print("=" * 80)
    
    # –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –º–æ–¥—É–ª—è
    module = TransformationMarker()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã
    test_cases = [
        {
            "name": "–ü—Ä–∏–º–µ—Ä 1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
            "text": (
                "–í –ø—Ä–æ—Ü–µ—Å—Å–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, "
                "—á—Ç–æ–±—ã –ø—Ä–∏–≤–µ—Å—Ç–∏ –∏—Ö –∫ –µ–¥–∏–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É. –ó–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è "
                "–¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤ –∏ —à—É–º–∞. –ù–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è "
                "–∞–≥—Ä–µ–≥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º."
            ),
            "transformations": ["–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è", "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è", "–∞–≥—Ä–µ–≥–∞—Ü–∏—è"]
        },
        {
            "name": "–ü—Ä–∏–º–µ—Ä 2: Machine Learning –ø–∞–π–ø–ª–∞–π–Ω",
            "text": (
                "–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 100 —ç–ø–æ—Ö. "
                "–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ. "
                "–ó–∞—Ç–µ–º –º–æ–¥–µ–ª—å —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —Ç–µ—Å—Ç–æ–≤–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ."
            ),
            "transformations": ["–æ–±—É—á–µ–Ω–∏–µ", "–≤–∞–ª–∏–¥–∞—Ü–∏—è", "—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"]
        },
        {
            "name": "–ü—Ä–∏–º–µ—Ä 3: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞",
            "text": (
                "–¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤. "
                "–ü–æ—Ç–æ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Å–ª–æ–≤ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ. "
                "–í –∫–æ–Ω—Ü–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é TF-IDF."
            ),
            "transformations": ["—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è", "–ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è", "–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"]
        }
    ]
    
    # –í—ã–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç—ã
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n{'‚îÄ' * 80}")
        print(f"üìù {test_case['name']}")
        print(f"{'‚îÄ' * 80}")
        
        print(f"\nüì• –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:")
        print(f"   {test_case['text']}")
        
        print(f"\nüîç –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞:")
        print(f"   {', '.join(test_case['transformations'])}")
        
        try:
            # –í—ã–∑—ã–≤–∞–µ–º –º–æ–¥—É–ª—å
            result = module(
                text=test_case['text'],
                transformations=test_case['transformations']
            )
            
            # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            print(f"\nüì§ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å –≤—ã–¥–µ–ª–µ–Ω–∏—è–º–∏:")
            print(f"   {result.marked_text}")
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å —Ü–µ–ø–æ—á–∫–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π (ChainOfThought)
            if hasattr(result, 'reasoning'):
                print(f"\nüí≠ –†–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:")
                print(f"   {result.reasoning}")
            
        except Exception as e:
            print(f"\n‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏: {e}")
            import traceback
            traceback.print_exc()
    
    print("\n" + "=" * 80)
    print("‚úÖ –î–µ–º–æ-—Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à—ë–Ω")
    print("=" * 80)
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    print("\nüí° –ü–æ–¥—Å–∫–∞–∑–∫–∏:")
    print("   - –ú–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ LLM")
    print("   - –í—ã–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ —Ç–µ–∫—Å—Ç—É, —Å–≤—è–∑–∞–Ω–Ω–æ–º—É —Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏")
    print("   - –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å transformations –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –∏–ª–∏ —Å—Ç—Ä–æ–∫—É")
    print("\nüìö –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:")
    print("   from module_transformation_marker import optimize")
    print("   optimized = optimize(dataset, max_metric_calls=50)")


if __name__ == "__main__":
    main()

